---
title: "[Infosec] Server-Side Request Forgery (SSRF) ì™„ì „ ì •ë¦¬"
date: 2025-09-13 23:00:00 +0900
categories: [ë³´ì•ˆ, Web]
tags: [ì›¹í•´í‚¹, ssrf, injection, security, web]
description: "ì„œë²„ë¥¼ ì´ìš©í•˜ì—¬ ìš”ì²­ì„ ìœ„ì¡°í•˜ë¼"
author: "ì†¡ì§€ë¯¼"
toc: true
---

# ì„œë²„ë¥¼ ì‹œì¼œ ë‚´ë¶€ë§ì„ í„¸ê²Œ ë§Œë“œëŠ” ì€ë°€í•œ ê³µê²©

**Server-Side Request Forgery (SSRF)** ëŠ” ì›¹ ì„œë¹„ìŠ¤ì˜ ìš”ì²­ì„ ë³€ì¡°í•˜ì—¬, **ì„œë²„ê°€ ëŒ€ì‹  ê³µê²©ìê°€ ì›í•˜ëŠ” ê³³ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ë§Œë“œëŠ” ì·¨ì•½ì **ì…ë‹ˆë‹¤.  
ë¸Œë¼ìš°ì €ê°€ ìš”ì²­ì„ ë³´ë‚´ëŠ” **CSRF**ì™€ ë‹¬ë¦¬, **SSRFëŠ” ì›¹ ì„œë¹„ìŠ¤ ìì²´ì˜ ê¶Œí•œìœ¼ë¡œ ìš”ì²­**ì„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ í° ì°¨ì´ì…ë‹ˆë‹¤.

ì¦‰, ê³µê²©ìëŠ” ì„œë²„ë¥¼ **í”„ë¡ì‹œ**ì²˜ëŸ¼ ì•…ìš©í•˜ì—¬ ë‚´ë¶€ë§ì´ë‚˜ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ë¥¼ ê³µê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âœ¨ ì™œ ìœ„í—˜í•œê°€?
- ì„œë²„ëŠ” **ë‚´ë¶€ë§ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œ**ì„ ê°€ì§€ê³  ìˆìŒ  
- ë°±ì˜¤í”¼ìŠ¤, ë‚´ë¶€ API, DB ê´€ë¦¬ í˜ì´ì§€ ë“±ì€ ì™¸ë¶€ì—ì„œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€ â†’ SSRFë¡œ ìš°íšŒ ê°€ëŠ¥  
- ìµœê·¼ **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜**ê°€ ëŠ˜ì–´ë‚˜ë©´ì„œ, SSRFì˜ íŒŒê¸‰ë ¥ì´ ë”ìš± ì»¤ì§  

---

## SSRF ë°œìƒ ìœ í˜•

### 1. ì´ìš©ìê°€ ì…ë ¥í•œ URLì— ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²½ìš°

```python
from flask import Flask, request
import requests

app = Flask(__name__)

@app.route("/image_downloader")
def image_downloader():
    image_url = request.args.get("image_url", "")
    response = requests.get(image_url)
    return (
        response.content,
        200,
        {"Content-Type": response.headers.get("Content-Type", "")},
    )
```

#### ë¬¸ì œì 
```bash
http://127.0.0.1:8000/image_downloader?image_url=http://127.0.0.1:8000/request_info
```
â†’ ë¸Œë¼ìš°ì € ì •ë³´ê°€ ì•„ë‹Œ **python-requests**ê°€ ì¶œë ¥ë¨.  
â†’ ì¦‰, ì‚¬ìš©ìê°€ ì•„ë‹ˆë¼ **ì„œë²„ê°€ ìš”ì²­ì„ ë³´ë‚¸ ê²ƒ**ì„.

---

### 2. ì›¹ ì„œë¹„ìŠ¤ ìš”ì²­ URLì— ì…ë ¥ê°’ì´ í¬í•¨ë˜ëŠ” ê²½ìš°

```python
INTERNAL_API = "http://api.internal/"

@app.route("/v1/api/user/information")
def user_info():
    user_idx = request.args.get("user_idx", "")
    response = requests.get(f"{INTERNAL_API}/user/{user_idx}")
```

#### ë¬¸ì œì 
```bash
http://api.internal/search?user_name=secret&user_type=private#&user_type=public
```
- `#` ì´í›„ ë¬¸ìì—´ì€ ë¬´ì‹œë˜ë¯€ë¡œ, ê³µê²©ìê°€ ì˜ë„í•œ **private** ì¿¼ë¦¬ ì‹¤í–‰ ê°€ëŠ¥

---

### 3. ìš”ì²­ Bodyì— ì…ë ¥ê°’ì´ í¬í•¨ë˜ëŠ” ê²½ìš°

```python
@app.route("/v1/api/board/write", methods=["POST"])
def board_write():
    title = request.form.get("title", "")
    body = request.form.get("body", "")
    data = f"title={title}&body={body}&user=guest"
    response = requests.post("http://127.0.0.1:8000/board/write", data=data)
    return response.content
```

#### ë¬¸ì œì 
```bash
title=title&user=admin&body=body&user=guest
```
- íŒŒë¼ë¯¸í„° ë®ì–´ì“°ê¸° â†’ **user=admin**ìœ¼ë¡œ ì¸ì‹

---

## ğŸ›  ê³µê²© í™œìš© ì˜ˆì‹œ

1. **ë‚´ë¶€ë§ ìŠ¤ìº”**
   ```bash
   /fetch?url=http://127.0.0.1:8080/admin
   ```

2. **í´ë¼ìš°ë“œ ë©”íƒ€ë°ì´í„° íƒˆì·¨**
   ```bash
   /fetch?url=http://169.254.169.254/latest/meta-data/
   ```

3. **Redis, Memcached ë“± ë¹„ì¸ê°€ ì ‘ê·¼**
   ```bash
   /fetch?url=gopher://127.0.0.1:6379/_FLUSHALL
   ```

---

## âœ… ë°©ì–´ ë°©ë²•
- í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ í—ˆìš©ëœ ë„ë©”ì¸ë§Œ ìš”ì²­  
- ë‚´ë¶€ë§ ì£¼ì†Œ (`127.0.0.1`, `169.254.*`, `::1`, `10.*`, `192.168.*`) ì°¨ë‹¨  
- í”„ë¡œí† ì½œ ì œí•œ (`http/https`ë§Œ í—ˆìš©, `file://`, `gopher://` ì°¨ë‹¨)  
- ìš”ì²­ ì‹œê°„ ì œí•œ / ì‘ë‹µ í¬ê¸° ì œí•œ  
- Proxy ë ˆì´ì–´ ë„ì…í•˜ì—¬ í•„í„°ë§  

